# Time Files

For this task, we were given a corrupted .png file that had been sent through a time machine. To solve this task, we have to open the corrupted file in some hex editor to view the hex dump of flag.png (here I use [Hex Fiend](https://hexfiend.com/)). From there, it's immediately made apparent that the header (the first 8 bytes) is completely wrong as seen here:

![hexfiend screenshot of initial flag.png](https://github.com/LeonDong02/issessions-2023/blob/main/Time%20Files/incorrectheader.png)

where the correct header should consist of the bytes 89 50 4E 47 0D 0A 1A 0A (read more about what these values mean [here](https://en.wikipedia.org/wiki/Portable_Network_Graphics#File_format)). Once you fix this, the file is not yet fixed and we have to take another look at the hex dump in order to see what's wrong. In the first line there is a hint where we can see that IHDR (a chunk specification for .png files), is reversed to become RDHI. If we look at the next line in the above picture, we can also see that if we reverse blocks of 4 bytes (a word) at a time, we can create another chunk specification IDAT. And for even more confirmation, we see the bytes after the the IHDR tag that represent the dimensions of the image are 0x20030000(537067520)px by 0xC8000000(3355443200)px which is far too large, and reversing the individual bytes produce a much more reasonable dimension of 0x00000320(800)px by 0x000000C8(200)px. Thus we can observe that every block of 4 bytes is in reverse order (very suitable for the time travel theme), and to fix this we can write a simple [script](https://github.com/LeonDong02/issessions-2023/blob/main/Time%20Files/fixpng.py) to read the original png byte by byte and reverse each word. The end result is a viewable png file that contains the flag retroCTF{youfixedit}.

![end result](https://github.com/LeonDong02/issessions-2023/blob/main/Time%20Files/fixed.png)
